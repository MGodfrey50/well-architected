---
title: Monitoring considerations for Azure VMware Solution workloads
description: See best practices for monitoring Azure VMware Solution workloads at the infrastructure and application levels.
author: Mahesh-MSFT
ms.author: maksh
ms.date: 08/10/2023
ms.topic: conceptual
ms.service: waf
ms.subservice: waf-workload-avs
---

# Monitoring considerations for Azure VMware Solution workloads

This article identifies the monitoring requirements of the Azure VMware Solution.  The guidance is intended for the operations team responsible for managing and maintaining the infrastructure and health of the environment. The focus is on what to monitor with guidance based on Microsoft and VMware native tools, however 3rd party tools can of course be used as alternatives.
Solution components that write to the VMware syslog include VMware ESXi, VMware vSAN, VMware NSX-T Data Center, and VMware vCenter Server.   When Diagnostics is enabled, those logs are written to the designated Log Analytics Workspace.


## Basic Health

*Impact: Operational excellence*

### Host Operations:
Ensure you are aware of pending host operations by setting up the notifications for host remediation activities (changes to underlying hardware).  

##### Recommendations

- You must be added to any one of the following RBAC roles in all subscriptions where an Azure VMware Solution is deployed.  Co-Administrator, Owner or Contributor or Service Administrator (Classic administrators).  
Ref: [Host Actions Notification](https://learn.microsoft.com/en-us/azure/azure-vmware/concepts-private-clouds-clusters#host-monitoring-and-remediation)

### Host monitoring and remediation:  

Understanding what Microsoft is doing as part of normal cloud operations to the Azure VMware environment requires you to configure the ‘Service Health’ monitoring function.  This service notifies you use ‘Alerts’ via  ‘Action Groups’ about service events. Make sure you add all the regions where you have the Azure VMware Solution deployed the select the four options ‘Service issue, planned maintenance, health advisories and security advisories’.  Divide these up to target specific operations teams as required.

#### Recommendation: 

- Enable health alerts and identify owners for each of the four alert types.     
Ref: [Service Health Alerts for Azure VMware Solution](https://learn.microsoft.com/en-us/azure/azure-vmware/configure-alerts-for-azure-vmware-solution)     
Ref: Integrating with VMware Aria Operation [Configuring an Azure VMware Solution Instance in VMware Aria Operations](https://docs.vmware.com/en/VMware-Aria-Operations/8.16/Configuring-Operations/GUID-6CDFEDDC-A72C-4AB4-B8E8-84542CC6CE27.html)


### Host performance and metrics: 
Use the monitoring metrics available in Azure to watch for threshold consumption levels of CPU, memory and storage that exceed recommendations. To obtain the logs, the ‘Diagnostics’ options must be configured for each SDDC.
You can also integrate the Azure VMware Solution with VMware Aria (separate service with its own licencing) to get performance optimization, efficient capacity and cost management, intelligent remediation, and integrated compliance. Azure Diagnostics can also be used to send logs to third party logging solutions using event hubs, storage accounts or directly to a supported partner solution.
#### 	Recommendation: 
- Enable the Azure VMware Solution performance metrics monitoring capabilities manually from the portal, using Bicep, Powershell, Terraform or the Azure CLI. 
- Leverage tools like VMware Aria to gather performance metrics.    
Ref:  Githup automated deployment of key metrics [Key monitoring metrics](https://github.com/Azure/Enterprise-Scale-for-AVS/blob/main/BrownField/PrivateCloud/AVS-PrivateCloud/readme.md)

### SDDC NSX-T monitoring: 
To access network logs , enable the Azure VMware Diagnostics options and send data to the designated Log Analytics Workspace.  This will enable access to the health data from the NSX_T appliances and to logs that the VMware syslog service collects. 
#### Recommendations:
- Enable the Azure VMware Solution ‘Diagnostics’ settings to send the logs to the custom Log Analytics Workspace.    
Ref: Configure VMware syslogs for Azure VMware Solution [NSX-T logging](https://learn.microsoft.com/en-us/azure/azure-vmware/configure-vmware-syslogs)     
Ref: Enable tagging on NSX-T Firewall rules and SNAT rules to facilitate searches in Azure Log Analytics. [Configuring NSX-T Firewall rules loggin](https://techcommunity.microsoft.com/t5/azure-migration-and/azure-vmware-solution-using-log-analytics-with-nsx-t-firewall/ba-p/4131302)     
(Note: Logging must be enabled for rules defined in NSX-T before they appear in the Azure log analytics workspace.  Logs generated by vCenter are sent automatically.)



## Managing Logs - Retention & Archive

*Impact: Operational excellence*

Azure Log Analytics allows you to store logs for up to 2 years.  An analysis of your log retention requirements should be done to identify which logs are required for longer term storage and/or which logs can be retained in a less expensive archive. If you have record immutability requirements, Azure VMware Solution diagnostics settings allow you to send the logs to an Azure native storage blob.  You can use tools such as Azure Logic Apps or Azure Functions to forward logs. You can use these tools to create listeners for incoming logs from Azure VMware Solution and to send the logs to a storage blob.

Archiving logs is a strategy for keeping your storage costs down. Azure Storage blobs and Log Analytics can transfer logs for long-term archival. Using a storage blob is the less expensive option. But Log Analytics has advanced integrations for alerting, visualization, querying, and gaining machine learning–based insights. Consider your budget, functional use cases, and long-term use cases when you choose a solution.


##### Recommendations

- Collect logs from the VMware syslog service to get health data from VMware solution components such as VMware ESXi, VMware vSAN, VMware NSX-T Data Center, and VMware vCenter Server.     
Ref: Configuring Log Analytics [Enabling Diagnostics for Azure VMware Solution](https://learn.microsoft.com/en-us/azure/azure-vmware/configure-vmware-syslogs)
- Configure tools such as VMware Aria Operations for Logging to collect various logs for querying, analyzing, and reporting capabilities.
- Configure retention durations for sending logs to long-term storage to reduce query time and save on storage costs.    
Ref: Log retention [Configure log retention and archive](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/data-retention-archive?tabs=portal-3%2Cportal-1%2Cportal-2)     
Ref: Log immutability [Securing logs](https://learn.microsoft.com/en-us/azure/storage/blobs/immutable-policy-configure-version-scope)     
Ref: Storing logs off-line [Long term retention using Azure storage](https://learn.microsoft.com/en-us/azure/azure-monitor/logs/logs-export-logic-app)
  


## Monitor the guest operating system

*Impact: Operational excellence*

Within the guest operating system, metrics are available for disk usage, application performance, system resource utilization, and user activity. Consider using Azure Arc for Azure VMware Solution (preview) to manage VMware infrastructure resources in Azure. For more information, see [Deploy Azure Arc for Azure VMware Solution](/azure/azure-vmware/deploy-arc-for-azure-vmware-solution).

##### Recommendations

- Enable guest management and install Azure extensions after your private cloud is enabled by Azure Arc for servers or Azure Arc for Azure VMware Solution (preview).
- Install extra agents to collect data to enable guest management and monitoring on Azure VMware Solution guest VMs.  

## Implement security monitoring

*Impact: Security, Operational excellence*

Security monitoring is critical for detecting and responding to anomalous activities. Workloads that run in an Azure VMware Solution private cloud need comprehensive security monitoring that spans networks, Azure resources, and the Azure VMware Solution private cloud itself. You can centralize security events by deploying a Microsoft Sentinel workspace. By using this integration, the operation team can view, analyze, and detect security incidents in the context of a broader organizational threat landscape.

##### Recommendations

- Enable [Defender for Cloud](/azure/defender-for-cloud/connect-azure-subscription) on the Azure subscription that you use to deploy the Azure VMware Solution private cloud. Ensure that in the Defender for Cloud plan, the **Cloud Workload Protection (CWP)** setting has a value of **ON** for servers.
- Audit actions that privileged users take on the Azure VMware Solution private cloud. For more information, see [Audit activity history for group assignments in privileged identity management](/azure/active-directory/privileged-identity-management/groups-audit).
- Integrate Microsoft Sentinel with Defender for Cloud. Enable its data collector for security events and connect it with Defender for Cloud.
- Use security monitoring solutions from validated partners in Azure VMware Solution.

## Monitor and analyze networks

*Impact: Security, Operational excellence*

The process of network monitoring inspects all the traffic that comes into and goes out of the Azure VMware Solution private cloud. In Azure VMware Solution, network security operates at the network and host layers.

##### Recommendations

- Capture and monitor network firewall logs that are deployed in the Azure VMware Solution private cloud. Also monitor logs that are deployed in Azure when your application extends to Azure native devices such as Azure Firewall or Azure Application Gateway. For more information, see [Firewall integration in Azure VMware Solution](https://techcommunity.microsoft.com/t5/azure-migration-and/firewall-integration-in-azure-vmware-solution/ba-p/2254961).
- Use [Azure Firewall Workbook](/azure/firewall/firewall-workbook) or similar tools to monitor common metrics and logs that are related to firewall devices.
- Correlate logs from multiple security vectors such as identity, networking, and infrastructure vectors.

## Configure and streamline alerts

*Impact: Operational excellence, Cost optimization*

When you run workloads in the Azure VMware Solution private cloud, you need to effectively monitor workload performance. For example, you should capture logs, metrics, and trace requests for your application and infrastructure layers.

Alerts can help you respond to changes in your performance baseline. You can also use alerts to provide information about necessary maintenance or configuration changes. For instance, you can receive notifications when a key expires, a connection is lost, or there's a risk of exceeding a resource's capacity.

To make alerts effective, configure them to notify accountable teams when certain conditions are met. Also consider consolidating alerts to reduce the number of individual notifications that are sent:

- Instead of issuing an alert for every machine that's low on space, consider consolidating alerts by hosts, resource groups, or clusters.
- Use this approach also with host issues, CPU, and storage spikes.
- Base alerts on time windows. For example, if a host issues alerts for a short time, you can suppress the alerts according to a defined time threshold. For instance, you can send an alert only after five minutes have passed.

##### Recommendations

- Discuss and establish baselines that are based on performance data.
- Define relevant alert criteria such as thresholds, severity levels, or specific conditions.
- Use the [VMware vSphere events and alarms subsystem](https://docs.vmware.com/en/VMware-vSphere/7.0/com.vmware.vsphere.monitoring.doc/GUID-9272E3B2-6A7F-427B-994C-B15FF8CADC25.html) to monitor VMware vSphere and set up triggers.
- Configure [Azure alerts in Azure VMware Solution](/azure/azure-vmware/configure-alerts-for-azure-vmware-solution#supported-metrics-and-activities) to respond to events in real time.
- Ensure that alerts are configured so that [VMware vSAN datastore slack space](/azure/azure-vmware/concepts-storage) is maintained at the levels that your service-level agreement (SLA) mandates.
- Configure resource health alerts to get the real-time health status of the Azure VMware Solution private cloud.
- Use application performance monitoring (APM) tools to gain performance insights at the application code level.
- Use a combination of monitoring techniques such as synthetic transactions, heartbeat monitoring, and endpoint monitoring.
- Prioritize alerts based on their impact on operations or the criticality of the affected systems. Fine-tune alerts to trigger only meaningful events.
- To reduce noise and effectively manage alerts, use methods for reducing the number of individual notifications that are issued.
- To minimize alert fatigue, employ a mechanism to notify key stakeholders only about significant events.
- Use notification channels such as SMS, email, push notifications, and collaboration platforms such as Microsoft Teams to ensure that alerts are delivered effectively.

## Manage costs

*Impact: Cost optimization, Operational excellence*

Cost monitoring refers to the ability to keep track of costs that are associated with the Azure VMware Solution private cloud.

##### Recommendations

- Use the VMware vSphere events and alarms subsystem to monitor VMware vSphere and set up triggers.
- Configure Azure alerts that are based on Log Analytics queries for Azure VMware Solution. These alerts help your operation team respond to expected and unexpected events in real time.

## Use troubleshooting and debugging tools

*Impact: Cost optimization, Operational excellence*

To efficiently debug and troubleshoot your application, you need logs, metrics, and associated information. This information includes event activities so that you can identify, analyze, and establish connections between events.

##### Recommendations

- Configure your system to forward logs from the Azure VMware Solution syslog service to Log Analytics. Forward all relevant logs, metrics, and diagnostic information.
- Configure a server agent that's enabled by Azure Arc on guest VMs that run inside the Azure VMware Solution private cloud.

## Use dashboards

*Impact: Operational excellence*

Application dashboards help you visualize and monitor an application's performance, health, and other metrics:

- Monitoring reports in dashboards help you do root-cause analysis and troubleshooting quickly. Operations teams can use these dashboards to view all key resources that make up Azure VMware Solution in a single pane.
- Dashboard metrics provide insight into how code and infrastructure changes impact application behavior.
- Visuals help customer support teams understand the impact of changes, performance, and availability issues on an application.
- Performance indicators benefit executive leadership and business stakeholders. These tools inform decisions that align an application's performance with business objectives. For example, an executive can monitor commitment to customers by reviewing metrics such as service availability, incident resolution times, and average response times. These metrics help ensure that the organization delivers services according to its SLA.

Besides offering insight, dashboards can also promote transparency and encourage collaboration, for instance, when you grant appropriate stakeholders access to application dashboards. This act cultivates a shared comprehension of an application's performance. This practice also enables an organization to make informed decisions. As a result, stakeholders can focus on pursuing crucial initiatives that propel the business forward.

##### Recommendations

- Build an application dashboard with Application Insights or Grafana. Connect the dashboard to relevant data sources that store metrics from your Azure VMware Solution environment.
- Create an Azure workbook as a central repository for commonly run queries, metrics, and interactive reports.
- Ensure that your data source aligns with security and compliance requirements.
- Define access controls and permissions such as user authentication and role-based access control. Ensure that each stakeholder has appropriate access that's based on their role.
- Conduct periodic access reviews to check that user access is up to date and aligned with current roles and responsibilities.

## Next steps

Now that you've looked at observability best practices in Azure VMware Solution, explore mechanisms, tools, and perimeters that you can use to further secure workloads in the SDDC.

> [!div class="nextstepaction"]
> [Security](./security.md)

Use the assessment tool to evaluate your design choices.

> [!div class="nextstepaction"]
> [Assessment](./assessment.md)