---
title: Oracle on Azure IaaS design area compute and storage
description: Review the design area for storage and compute of the Azure Well-Architected Framework. See how to apply these principles to Oracle on Azure IaaS workloads.
author: jessiehaessler
ms.author: 
ms.date: 
ms.topic: conceptual
ms.service: waf
ms.subservice: waf-workload-Oracle
---

# Compute and Storage

Azure presents an opportunity to migrate Oracle workloads to match on-premises in an Infrastructure as a Service, (IaaS) model. However, Oracle can often present hurdles to the cloud due to the complexity, size and high IO demands of the workload. The Oracle database performance is strictly influenced by the following parameters: read/write Disk throughput (MBPs), read/write IOPS, CPU, RAM and Network latency. As such it is crucial to understand clearly how to choose the right combination of compute and storage on Azure IaaS for the migration of Oracle workloads to be successful. 

This article discusses the right-sizing of both compute and storage for your Oracle workload on Azure IaaS in order to achieve a successful cloud deployment. 

## Assessing the Oracle workload using AWR Reports
In order to generate right-sizing recommendations for the required Azure infrastructure, you will need to generate an Automatic Workload Repository (AWR)/ statspack report for each database that you plan to migrate to Azure.

The AWR is a detailed performance analysis report generated by Oracle database. It provides comprehensive information about database performance, wait events, system resources, and much more. The AWR report is included with Oracle Database Enterprise Edition - Diagnostic Pack option. However, if you are running an Enterprise edition without a Diagnostic Pack license or the Standard Edition then the Statspack report should be used as an alternative to the AWR report.
Keep in mind that you should always have a look onto the peak-load. If the peak-load occurs on backup timings during the night and Backup RTO/RPO requirements are inline with 4 hours, then please repeat the same exercise for an average load. 
**Note that a peak-load usually is a window of 1 hour. You can determine your peak-load by utilizing the Oracle Enterprise Manager. If you do not have a license for it or dont use it, you can leverage the following script which provides you with the [top 5 busiest times](https://github.com/Azure/Oracle-Workloads-for-Azure/blob/main/az-oracle-sizing/busiest_awr.sql). On which basis you generate the AWR report as usual. This script is available for Standard and Enterprise Edition Databases. Please route within the Github folder.**

### Assessment question
Do you have meaningful AWR reports for your Oracle database to evaluate its performance? 

### Recommendations
- Generate comprehensive AWR reports for a database right-sizing exercise. 
- Generate the busiest AWR report for peak workload during short periods, such as one hour or thirty minutes. 
- Generate a Peak-load AWR report. Additionally an average-load if desired.
- If available, provide any additional AWR reports that may cover important characteristics of the database workload, such as end-of-month or end-of-quarter reporting periods.
- The report should be in html format in order to be used by the right-sizing tool.
- If you are not sure when your peak-load happens, you can leverage the following scripts which will provide the top 5 busiest times:
    - [AWR](https://github.com/Azure/Oracle-Workloads-for-Azure/blob/main/az-oracle-sizing/busiest_awr.sql).
    - [statspack](https://github.com/Azure/Oracle-Workloads-for-Azure/blob/main/az-oracle-sizing/busiest_statspack.sql).
 
## Right-size your Oracle Database

It is important to have the ability to analyze the AWR or Statspack reports of your Oracle workloads carefully in order to right-size your Azure infrastructure so that it is capable of meeting the performance requirements. Such analyses is based on expert understanding of all aspect of database performance and requires automated tools in order to consider all the associated variables.

### Assessment question
- Do you have the capability to assess the AWR or Statspack reports in an automated manner to generate right-sizing recommendations? 

### Recommendations
- Gain access to automated right-sizing tools.  Oracle Migration Assistant Tool [(OMAT)]((https://github.com/Azure/Oracle-Workloads-for-Azure/tree/main/omat)) helps to understand resource usage on Oracle installations (on premise or in any cloud) and recommends the most suitable virtual machine and storage that can run the same workload on Azure. It works by processing Automatic Workload Repository (AWR) reports collected from the source system. Required data is extracted from AWR files and placed into an Excel workbook. For more information on different sections of workbook and the algorithm behind calculations see [AWR sizing document](https://github.com/Azure/Oracle-Workloads-for-Azure/blob/main/az-oracle-sizing/AWR%20Sizing%20Instructions.pdf).
- OMAT essentially automates steps defined in the AWR sizing document to speed up the process and to relieve the user from complexities of interpreting the AWR report.
- Seek experts with the skills to understand the implications of the recommendations generated by OMAT.

## Choose the right VM for your Workload

The OMAT tool provides the optimal sizing recommendations for Oracle on Azure IaaS. You then have to make a decision on choosing one of the OMAT recommendations to implement your workload on Azure.

### Assessment question
Do you have the capability to compare different Azure VM families and skus in terms of cost and performance factors? 

### Recommendations
- The [E-series](https://learn.microsoft.com/en-us/azure/virtual-machines/edv5-edsv5-series)- and [M-series](https://learn.microsoft.com/en-us/azure/virtual-machines/m-series) Virtual Machines are the common choices for your database. The E-series can handle very high throughput values, while the M-series should be leveraged when your workload requires high memory. Both are hyper-threaded enabled. 
- Each Virtual Machine family comes with a selection of sizes and can be matched to your needs.  Microsoft also offers so called [constrained core sizes](https://learn.microsoft.com/en-us/azure/virtual-machines/constrained-vcpu?tabs=family-E). Constrained core sizes provide the same machine but with fewer cores to optimize Oracle licensing.
- Leverage the Azure Pricing tools to compare the cost of the different Azure VM recommendations.
- Aim to leverage Azure reservations to reduce the cost of your compute infrastructure.

## Storage considerations for Oracle on Azure IaaS.

Choosing the right Azure storage for the database depends on many factors including the database size, IOPS and Throughput. Azure Managed Disks and Azure Netapp Files are great storage options. Azure Premium Managed Disks provide excellent capabilities for Oracle workloads. Some Databases require a more performant storage solution as would be evident from the right-sizing assessment. Azure Netapp files are a great choice in this scenario.

Other storage considerations are related to the Redologs Archives and backups. Archiving redologs is typically an ongoing read/write operation. These need to be looked at based on the solution requirements and availability.

The following provides an example storage-layout:

| Disk Name  |  Function | Size (GB) |Throughput |  IOPS | Disk Recommendation  |
|---|---|---|---|---|---|
| odiag |  Diagnostics Dest (trace and log files) |  50 |  308 | 966  | 2*P30 (striped to RAID-0)
| oagnt  | Oracle CC agent | 10  | 100  | 350  | P10
|oredo | Online Redologs  | 400  |  150 |  1500 | P20
| oapp  |  Oracle Software |  50 | 50  | 200  | P6
| otemp  | Temp tablespace |  2000 | 150  | 1250  | P40
| oarch  | Archive Redologs  | 7000  | 300  |  1250 | Azure Blob Storage configured in Hot Tier
| odata  | Data Files & Control File   |  18000 | 1000  | 2500 | 5*P50 (striped to RAID-0)

**Note that the log files can also be put seperately. Oracle ASM Storage layouts need to be adjusted to Oracle ASM requirements.**

If you need to provision more than 1 disk per logical volume as you see in the table above, please make sure it is striped to RAID-0 for maximum performance. Whereever Premium v2 disks are available, you can also make use of it. Please check availabilites per region before deployment.
If you decide to use Premium v1 disks make sure the host-level caching is set to read-only.

Further notice: If you use Oracle ASM and Managed Disks the size configured in ASM is decisive. This means if you configured ASM for a maximum size of 4096 GB, ASM can only process this amount. It results in that even if you provision higher Disks, ASM would not recognize the space. Please plan for it accordingly and rather decide to provision a certain number of 4095 GB and stripe these again for better performance.  

### Assessment question
- What factors did you consider when selecting your storage solutions for the different components of the workload?
- Do you have a storage layout planned and in place?
- Did you plan for archive log availability?

### Recommendations
- Use the recommendations generated by the OMAT tool to guide you through your database storage options.
- Understand the different Azure disk types and how they fit into your workload requirements by studying [Disk Types](https://learn.microsoft.com/en-us/azure/virtual-machines/disks-types).
-Review best practices on disk configuration in [Disk Types and Configurations](https://learn.microsoft.com/en-us/azure/virtual-machines/workloads/oracle/oracle-design#disk-types-and-configurations).
- If you would like to consider Azure Netapp Files as your storage layer then you can find further information about [Azure Netapp Files for Oracle](https://learn.microsoft.com/en-us/azure/architecture/example-scenario/file-storage/oracle-azure-netapp-files).
- In case you are decoupling from an Exadata, you might also want to have a look at [Application Volume Groups](https://learn.microsoft.com/en-us/azure/azure-netapp-files/performance-oracle-multiple-volumes).
- Suitable options for Redolog archives are [Azure Files (hot tier)](https://learn.microsoft.com/en-us/azure/storage/files/understand-performance#choosing-a-performance-tier-based-on-usage-patterns), especially for large volumes, and Azure Premium Managed disks.
- The Backup option should be based on the data volume and your technical and non-technical requirements. 
- The following provides an overview of [Backup Strategies for Oracle Workloads](https://learn.microsoft.com/en-us/azure/virtual-machines/workloads/oracle/oracle-database-backup-strategies).
- Plan for your storage layout to avoid performance impact.

## How to size the compute infrastructure needed for (Oracle) Applications?

Oracle applications can typically be moved to Azure using VMs with similar capabilities as those utilized in the on-premise deployment.

### Assessment question
Do you have a clear view of the compute requirements of your Oracle applications?

### Recommendations
- On the application tier, it is important to have available data points from the web tier and the application tier including: 
    -   No. of vCPU’s 
    -	Average Utilization of vCPU 
    -	Memory Size 
    -	Average memory utilization 
    -	App Storage Size
    -	App version
    -	Operating System
    -	Total IOPS
    -	Total Throughput
    -	Backup Strategy
- The application tier can be moved to any suitable VM SKU that meets the performance and cost optimization requirements.

## Next steps
> [!div class="nextstepaction"]
> [Backup and Disaster Recovery BCDR](./bcdr.md) 