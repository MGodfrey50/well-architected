---
title: Recommendations for designing a reliable monitoring and alerting strategy
description: Learn how to design a reliable monitoring and alerting strategy.
author: claytonsiemens77
ms.author: csiemens
ms.date: 11/15/2023
ms.topic: conceptual
---

# Recommendations for designing a reliable monitoring and alerting strategy

**Applies to: RE:10**

This guide describes the best practices for designing a reliable monitoring and alerting strategy to ensure that your operations teams are always aware of your environment health and that the reliability targets that have been established for your workloads are being met.

## Definitions

|Term  |Definition  |
|---------|---------|
| Resource logs     | Data generated by a system about the state of the system        |
|Metrics    | Numerical values that are collected at regular intervals and describe some aspect of a system at a particular time        |
|Traces     | Data about the path a request travels through different services and components        |

## Key design strategies

This guide assumes that you have already performed the following tasks as part of your reliability planning:

-   Identified critical and non-critical flows (link to RE:01)

-   Performed failure mode analysis (FMA) for your flows (link to RE:02)

-   Identified reliability targets (link to RE:03)

-   Designed for reliability through redundancy (link to RE:04), scaling (link to RE:05), self-preservation (link to RE:06) and self-healing (link to RE:07)

-   Designed a robust testing strategy (link to RE:08)

To ensure that your workload is operating reliably and that your operations teams know when conditions change, and that they react to issues as quickly as possible, you must have a robust and reliable monitoring and alerting strategy. A robust and reliable monitoring strategy is built upon the health models (link to RE:03/health modeling anchor point) that you have developed for your critical flows and the workloads they comprise. The health model defines healthy, degraded, and unhealthy states, and your monitoring posture should be tailored to catch changes in these states immediately. When health states change from healthy to degraded or unhealthy, the automatic corrective measures that you have enabled (link to RE:07) and alerts to the appropriate teams should be initiated through your alerting mechanisms.

The following design recommendations will help you design a monitoring and alerting strategy that meets the requirements of your business.

## General guidance

-   Understand the difference between [metrics](https://learn.microsoft.com/azure/azure-monitor/essentials/data-platform-metrics), [logs](https://learn.microsoft.com/azure/azure-monitor/logs/data-platform-logs), and [traces](https://learn.microsoft.com/azure/azure-monitor/app/asp-net-trace-logs)

-   Enable logging for all cloud resources

    -   Use automation in your deployments and governance to ensure that diagnostic logging is enabled throughout your environment

-   Forward all diagnostic logs to a centralized data sink and analytics platform, like a [Log Analytics workspace](https://learn.microsoft.com/azure/azure-monitor/logs/log-analytics-workspace-overview)

    -   If you have regional data sovereignty requirements, you will need to use local data sinks in the regions subject to those requirements

-   If your workloads are subject to one or more compliance frameworks, some of the logs from components that may handle sensitive information will also be subject to those frameworks and should be sent to a security information and event management (SIEM) system, like Microsoft Sentinel

-   Create a log retention [policy](https://learn.microsoft.comazure/azure-monitor/logs/data-retention-archive?tabs=portal-1%2Cportal-2) that incorporates any long-term retention requirements dictated by the compliance frameworks your workloads are subject to.

-   Use [structured logging](https://stackify.com/what-is-structured-logging-and-why-developers-need-it/) for all log messages to optimize querying the log data

-   Alerts should be configured to initiate when values pass critical thresholds, correlating to a health model state change (green to yellow or red)

    -   Threshold configuration should be a practice of continuous improvement. As your workload evolves over time, the thresholds you define may change. In some cases, [dynamic thresholds](https://learn.microsoft.com/azure/azure-monitor/alerts/alerts-dynamic-thresholds) may be a good option for your monitoring strategy.

-   Consider using alerting when states improve (red to yellow, or red to green) so that the operations teams can track these events for future reference.

-   Visualize the real-time health of your environment using custom [dashboards](https://learn.microsoft.com/azure/azure-monitor/visualize/tutorial-logs-dashboards)

-   Use data gathered during incidents to continuously improve your health models (link to RE:03) and your monitoring and alerting strategy

-   Incorporate the cloud platform monitoring and alerting services that are available to you. This can include:

    -   Platform level health, like [Azure Service Health](https://learn.microsoft.com/azure/service-health/service-health-overview)

    -   Resource level health, like [Azure Resource Health](https://learn.microsoft.com/azure/service-health/resource-health-overview)

-   Incorporate purpose-built advanced monitoring and analytics for specific functions offered by your cloud provider, like Azure Monitor's [Insights](https://learn.microsoft.com/azure/azure-monitor/overview#insights) tools

-   Implement backup and recovery monitoring to capture the following:

    -   Data replication status to ensure that recovery can be achieved within the target RPO

    -   Successful and failed backups and recoveries

    -   Recovery duration to inform your disaster recovery planning (link to RE:09)

## Application monitoring

-   Create health probes or [check functions](https://learn.microsoft.com/azure/architecture/patterns/health-endpoint-monitoring) and run them regularly from outside the application.

    -   Ensure that you are testing from multiple locations geographically close to your customers

-   Log data in the production environment. Capture robust data while the application is running in the production environment. You need sufficient information to diagnose the cause of issues in the production state.

-   Log events at service boundaries. Include a correlation ID that flows across service boundaries. If a transaction flows through multiple services and one of them fails, the correlation ID helps you track requests across your application and pinpoint why the transaction failed.

-   Use asynchronous logging. Synchronous logging operations sometimes block your application code. This situation causes requests to back up as logs are written. Use asynchronous logging to preserve availability during application logging.

-   Separate application logging from auditing. Audit records are commonly maintained for compliance or regulatory requirements and must be complete. To avoid dropped transactions, maintain audit logs separately from diagnostic logs.

-   [Telemetry correlation](https://learn.microsoft.com/azure/azure-monitor/app/distributed-tracing-telemetry-correlation) should be used to ensure that transactions can be mapped through the end-to-end application and critical system flows. This process is vital to root cause analysis (RCA) for failures. Platform level metrics and logs, such as CPU percentage, network in/out, and disk operations/sec, should be collected from the application to inform a health model and to detect and predict issues. This approach can also help to distinguish between transient and non-transient faults.

-   Use white-box monitoring to instrument the application with semantic logs and metrics. Application level metrics and logs, such as current memory consumption or request latency, should be collected from the application to inform a health model and to detect and predict issues.

-   Use black-box monitoring to measure platform services and the resulting customer experience. Black-box monitoring tests externally visible application behavior without knowledge of the internals of the system. This approach is common for measuring customer-centric service-level indicators (SLIs), service-level objectives (SLOs), and service-level agreements (SLAs).

## Data and storage monitoring

-   Monitor the availability metrics of your storage containers. When this metric drops below 100%, it is an indicator of failing writes. Transient drops in availability may happen when your cloud provider is managing load, so track the availability trends to understand whether there is an issue with your workload

    -   In some cases, a drop in the availability metrics for a storage container could indicate a bottleneck in the compute layer associated with the storage container.

-   There are many metrics to monitor for databases and your database administrators will have specific metrics that interest them, but in the context of reliability, the important metrics to monitor include:

    -   Query duration

    -   Timeouts

    -   Wait times

    -   Memory pressure

    -   Locks

## Azure facilitation

-   [Azure Monitor](https://learn.microsoft.com/azure/azure-monitor/overview) is a comprehensive monitoring solution for collecting, analyzing, and responding to monitoring data from your cloud and on-premises environments. 

-   [Log Analytics](https://learn.microsoft.com/azure/azure-monitor/logs/log-analytics-overview) is a tool in the Azure portal that\'s used to edit and run log queries against data in the Log Analytics workspace.

-   Refer to the Log Analytics workspace [architecture guide](https://learn.microsoft.com/azure/azure-monitor/logs/workspace-design) for best practices when using multiple workspaces.

-   [Application Insights](https://learn.microsoft.com/azure/azure-monitor/app/app-insights-overview?tabs=net) is an extension of Azure Monitor and provides application performance monitoring (APM) features.

-   Azure Monitor Insights are advanced analytics tools focused on specific Azure technologies (like VMs, App Services, Containers, and more) built on top of Azure Monitor and Log Analytics

-   [Azure Monitor for SAP solutions](https://learn.microsoft.com/azure/sap/monitor/about-azure-monitor-sap-solutions) is an Azure-native monitoring product for SAP landscapes that run on Azure

-   [Azure Policy](https://learn.microsoft.com/azure/governance/policy/overview) helps to enforce organizational standards and to assess compliance at-scale.

## Tradeoff

Storing and querying logs has cost implications. Be sure to understand how your log analysis and retention affects your budget and determine the best balance of utilization to meet your requirements. Refer to the [best practices](https://learn.microsoft.com/azure/azure-monitor/best-practices-logs#cost-optimization) guide to learn about cost optimization.

Refer to the [Health Endpoint Monitoring](https://learn.microsoft.com/azure/architecture/patterns/health-endpoint-monitoring#issues-and-considerations) design pattern guide for detailed guidance on issues and considerations around application monitoring.

## Example

Refer to the [Web application monitoring](https://learn.microsoft.com/azure/architecture/web-apps/guides/monitoring/app-monitoring) on Azure example architecture and the [AKS baseline cluster](https://learn.microsoft.com/azure/architecture/reference-architectures/containers/aks/baseline-aks#monitor-and-collect-metrics) reference architecture for examples of real-world monitoring solutions.

## Related links
